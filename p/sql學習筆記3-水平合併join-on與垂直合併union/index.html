<!DOCTYPE html>
<html lang="zh-tw">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='了解JOIN ON、UNION的使用方式，也用實際例子來做筆記'><title>SQL學習筆記(3)-水平合併(JOIN ON)與垂直合併(UNION)</title>

<link rel='canonical' href='https://yen0304.github.io/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='SQL學習筆記(3)-水平合併(JOIN ON)與垂直合併(UNION)'>
<meta property='og:description' content='了解JOIN ON、UNION的使用方式，也用實際例子來做筆記'>
<meta property='og:url' content='https://yen0304.github.io/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/'>
<meta property='og:site_name' content='Yen&#39;s部落格'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='SQL學習筆記' /><meta property='article:tag' content='SQL' /><meta property='article:tag' content='SQLite' /><meta property='article:published_time' content='2022-01-12'/><meta property='article:modified_time' content='2022-01-12'/><meta property='og:image' content='https://yen0304.github.io/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/logo.jpeg' />
<meta name="twitter:title" content="SQL學習筆記(3)-水平合併(JOIN ON)與垂直合併(UNION)">
<meta name="twitter:description" content="了解JOIN ON、UNION的使用方式，也用實際例子來做筆記"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://yen0304.github.io/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/logo.jpeg' />
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-204387403-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="https://yen0304.github.io" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span></span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/">
                <img src="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/logo_hue91c0a6a1fc261792a7714a8d89d8466_163197_800x0_resize_q75_box.jpeg"
                        srcset="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/logo_hue91c0a6a1fc261792a7714a8d89d8466_163197_800x0_resize_q75_box.jpeg 800w, /p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/logo_hue91c0a6a1fc261792a7714a8d89d8466_163197_1600x0_resize_q75_box.jpeg 1600w"
                        width="800" 
                        height="535" 
                        loading="lazy"
                        alt="Featured image of post SQL學習筆記(3)-水平合併(JOIN ON)與垂直合併(UNION)" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98/" >
                SQL學習筆記
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/">SQL學習筆記(3)-水平合併(JOIN ON)與垂直合併(UNION)</a>
    </h2>

    
    <h3 class="article-subtitle">
        了解JOIN ON、UNION的使用方式，也用實際例子來做筆記
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2022-01-12</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h1 id="sql學習筆記3-水平合併join-on與垂直合併union">SQL學習筆記(3)-水平合併(JOIN ON)與垂直合併(UNION)</h1>
<h2 id="前言">前言</h2>
<p>本系列大多部分來自Hahow的課程－<a class="link" href="https://hahow.in/courses/5fd24f017687e53b086c7fe7/discussions"  target="_blank" rel="noopener"
    >SQL的50道練習</a>，學習過程中得到的筆記，文章內容也有部份都是從教材擷取出來，如果有興趣可以去上課看看。</p>
<p>那這章的基本語法其實網路上的網站<a class="link" href="https://www.fooish.com/sql/"  target="_blank" rel="noopener"
    >fooish</a>都講得蠻完善的了，部分文章內容也會引用網站文章內容。</p>
<p>網路上有人說程式會忘記是很正常的，也因為這次JOIN ON的用法很有趣，所以這次的文章比較多是自己做的圖片，或是個人見解，我希望把程式用白話的方式一一來理解，讓自己能真正的理解他。</p>
<h2 id="開發環境">開發環境</h2>
<p>電腦系統：macOS（Big Sur）</p>
<p>資料庫管理工具：DBeaver</p>
<p>使用語言：SQLite</p>
<h2 id="join-on-水平合併">JOIN ON 水平合併</h2>
<p>在JOIN功能中，SQLite分為<code>LEFT JOIN ON</code>以及<code>JOIN ON</code>，但其實差別不大，<code>LEFT JOIN ON</code>的意思是希望保留以左側觀測值為主的資料，但一般來說都會指定要顯示的資料來自於哪個資料表，
所以在SQL中就只有<code>LEFT JOIN ON</code>而沒有<code>JOIN ON</code>。</p>
<h3 id="格式">格式</h3>
<p>概念圖：<figure style="flex-grow: 287; flex-basis: 690px">
		<a href="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/1.jpg" data-size="1478x514"><img src="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/1.jpg"
				srcset="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/1_hud0ec170b20ae697fc25bba9a5365a5e9_148632_480x0_resize_q75_box.jpg 480w, /p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/1_hud0ec170b20ae697fc25bba9a5365a5e9_148632_1024x0_resize_q75_box.jpg 1024w"
				width="1478"
				height="514"
				loading="lazy"
				>
		</a>
		
	</figure></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span><span class="w"> </span><span class="n">left_table</span><span class="p">.</span><span class="n">column_names</span><span class="p">,</span><span class="w">
</span><span class="w">       </span><span class="n">right_table</span><span class="p">.</span><span class="n">column_names</span><span class="w">
</span><span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="k">table_name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">left_table</span><span class="w">
</span><span class="w">  </span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="k">table_name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">right_table</span><span class="w">
</span><span class="w">    </span><span class="k">ON</span><span class="w"> </span><span class="n">left_table</span><span class="p">.</span><span class="n">join_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">right_table</span><span class="p">.</span><span class="n">join_key</span><span class="p">;</span><span class="w">
</span></code></pre></div><h3 id="實際使用情境舉例">實際使用情境舉例</h3>
<p>水平合併的作用在於，今天如果有兩個資料表，一個是</p>
<p>以及學生個人資料表table1資料表，其中裡面存放學生的學號number以及姓名name</p>
<p>學生的考試成績table2資料表，其中存放成績score以及學號number</p>
<p>所以我們想要顯示學生的成績以及姓名時，就需要把兩個欄位一起合併再來顯示，</p>
<p>概念大概是這樣：</p>
<table>
<thead>
<tr>
<th>number</th>
<th>name</th>
<th></th>
<th>number</th>
<th>score</th>
<th></th>
<th>number</th>
<th>name</th>
<th>score</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>A</td>
<td>+</td>
<td>1</td>
<td>90</td>
<td>=</td>
<td>1</td>
<td>A</td>
<td>90</td>
</tr>
<tr>
<td>2</td>
<td>B</td>
<td>+</td>
<td>2</td>
<td>100</td>
<td>=</td>
<td>2</td>
<td>B</td>
<td>100</td>
</tr>
<tr>
<td>3</td>
<td>C</td>
<td>+</td>
<td>3</td>
<td>80</td>
<td>=</td>
<td>3</td>
<td>C</td>
<td>80</td>
</tr>
</tbody>
</table>
<p>上面的例子來說，我們要合併的關鍵是兩個資料表所擁有一樣定義的值，這個值在<strong>資料庫的實體關係圖</strong>（ER Diagram, Entity Relationship Diagram）找到，這些值就是來自於元資料的定義，那在上面的例子中就是學生的學號，這時學號我們就會稱為他為<strong>結合鍵</strong>（Join Key），</p>
<h3 id="撰寫流程">撰寫流程</h3>
<p>在流程上</p>
<p>1.可以先決定左側表格</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span><span class="w">
</span><span class="w">	</span><span class="k">FROM</span><span class="w"> </span><span class="n">table1</span><span class="w"> </span><span class="c1">---先決定有學生學號的左側表格
</span></code></pre></div><p>2.決定右側要合併的表格，以及跟左側表格合併的結合鍵</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">table2</span><span class="w"> </span><span class="c1">--要合併的表格
</span><span class="c1"></span><span class="w">    	 </span><span class="k">ON</span><span class="w"> </span><span class="n">table2</span><span class="p">.</span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">table1</span><span class="p">.</span><span class="nb">number</span><span class="w"> </span><span class="c1">--結合鍵
</span></code></pre></div><p>３.結合1+2之後，寫上SELECT後面要選擇顯示的資料</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span><span class="w"> </span><span class="n">table1</span><span class="p">.</span><span class="nb">number</span><span class="p">,</span><span class="n">table1</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="n">table2</span><span class="p">.</span><span class="n">score</span><span class="w">
</span><span class="w">	</span><span class="k">FROM</span><span class="w"> </span><span class="n">table1</span><span class="w">
</span><span class="w">	</span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">table2</span><span class="w"> </span><span class="c1">--要合併的表格
</span><span class="c1"></span><span class="w">    	       </span><span class="k">ON</span><span class="w"> </span><span class="n">table2</span><span class="p">.</span><span class="nb">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">table1</span><span class="p">.</span><span class="nb">number</span><span class="w"> </span><span class="c1">--結合鍵
</span></code></pre></div><p>就完成了，</p>
<p>再來看比較複雜的應用</p>
<h3 id="進階使用">進階使用</h3>
<p><em><strong>在50道連習題當中，有一題目如下：</strong></em></p>
<p>從 nba 資料庫查詢各個球隊的得分王（生涯場均得分 ppg 全隊最高）是誰，將查詢結果依隊伍名排序，參考下列的預期查詢結果。</p>
<pre><code>                      team                   player   ppg
0            Atlanta Hawks               Trae Young  24.0
1           Boston Celtics             Kemba Walker  19.8
2            Brooklyn Nets             Kevin Durant  27.1
3        Charlotte Hornets              LaMelo Ball  15.9
4            Chicago Bulls              Zach LaVine  18.8
5      Cleveland Cavaliers            Collin Sexton  19.7
6         Dallas Mavericks              Luka Doncic  25.6
7           Denver Nuggets             Nikola Jokic  18.0
8          Detroit Pistons             Josh Jackson  12.0
9    Golden State Warriors            Stephen Curry  23.8
10         Houston Rockets                John Wall  19.0
</code></pre><p>​</p>
<p>ER圖：</p>
<p><figure style="flex-grow: 140; flex-basis: 337px">
		<a href="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/nbaer.jpg" data-size="1028x730"><img src="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/nbaer.jpg"
				srcset="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/nbaer_hue4bb0eb2148bc01f8a6d9a6c3b7217b0_351752_480x0_resize_q75_box.jpg 480w, /p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/nbaer_hue4bb0eb2148bc01f8a6d9a6c3b7217b0_351752_1024x0_resize_q75_box.jpg 1024w"
				width="1028"
				height="730"
				loading="lazy"
				>
		</a>
		
	</figure></p>
<h4 id="分析">分析</h4>
<p>Career_summaries資料表記錄著用球員id「personId」來做主鍵，裡面放著有關於得分的資料，再來players資料表裡面用「personId」記錄著球員的姓名以及其他球員資料還有所屬球隊的id「teamId」，再來teams資料表裡面用「teamId」記錄著隊伍的資料，所以我們先把希望呈現出來的成果分為左右表格分析，</p>
<p>可以從預期結果裡面來規劃，隊伍連結球員，球員連結得分</p>
<h4 id="撰寫流程-1">撰寫流程</h4>
<p>1.在最左側的隊伍名稱在隊伍裡面，所以：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span><span class="w">	
</span><span class="w">	</span><span class="k">FROM</span><span class="w"> </span><span class="n">teams</span><span class="w">
</span></code></pre></div><p>2.再來用裡面的teamId來連結players資料表，也因為球員資料裡面記錄著所屬球隊的id：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span><span class="w">	</span><span class="c1">--1.
</span><span class="c1"></span><span class="w">	</span><span class="k">FROM</span><span class="w"> </span><span class="n">teams</span><span class="w"> 
</span><span class="w">	</span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">players</span><span class="w">  </span><span class="c1">--2.
</span><span class="c1"></span><span class="w">	  </span><span class="k">ON</span><span class="w"> </span><span class="n">teams</span><span class="w"> </span><span class="p">.</span><span class="n">teamId</span><span class="w"> </span><span class="o">=</span><span class="n">players</span><span class="w"> </span><span class="p">.</span><span class="n">teamId</span><span class="w"> 
</span></code></pre></div><p>3.再來，要連結球員個人資料表players，他跟Career_summaries資料表可以用記錄著用球員id「personId」來跟players 資料表中的teamId 做結合鍵。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">teams</span><span class="w"> </span><span class="c1">--加入 
</span><span class="c1"></span><span class="w">	 </span><span class="k">ON</span><span class="w"> </span><span class="n">players</span><span class="w"> </span><span class="p">.</span><span class="n">personId</span><span class="w"> </span><span class="o">=</span><span class="n">career_summaries</span><span class="w"> </span><span class="p">.</span><span class="n">personId</span><span class="w">
</span></code></pre></div><p>4.1+2+3變成了：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span><span class="w">	</span><span class="c1">--1.
</span><span class="c1"></span><span class="w">	</span><span class="k">FROM</span><span class="w"> </span><span class="n">teams</span><span class="w"> 
</span><span class="w">	</span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">players</span><span class="w">  </span><span class="c1">--2.
</span><span class="c1"></span><span class="w">	  </span><span class="k">ON</span><span class="w"> </span><span class="n">teams</span><span class="w"> </span><span class="p">.</span><span class="n">teamId</span><span class="w"> </span><span class="o">=</span><span class="n">players</span><span class="w"> </span><span class="p">.</span><span class="n">teamId</span><span class="w">	
</span><span class="w">	</span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">teams</span><span class="w"> </span><span class="c1">--加入  --3
</span><span class="c1"></span><span class="w">	  </span><span class="k">ON</span><span class="w"> </span><span class="n">players</span><span class="w"> </span><span class="p">.</span><span class="n">personId</span><span class="w"> </span><span class="o">=</span><span class="n">career_summaries</span><span class="w"> </span><span class="p">.</span><span class="n">personId</span><span class="w">
</span></code></pre></div><p>5.再來會要使用聚合函數MAX來取ppg的最大值，所以一想到聚合函數還有隊伍，就會想到分組的GROUP BY</p>
<p>所以：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span><span class="w"> </span><span class="n">teams</span><span class="w"> </span><span class="p">.</span><span class="n">fullName</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">team</span><span class="p">,</span><span class="w">
</span><span class="w">		</span><span class="n">players</span><span class="p">.</span><span class="n">firstName</span><span class="w"> </span><span class="o">||</span><span class="s1">&#39; &#39;</span><span class="o">||</span><span class="n">players</span><span class="p">.</span><span class="n">lastName</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">player</span><span class="p">,</span><span class="w">
</span><span class="w">		</span><span class="k">MAX</span><span class="p">(</span><span class="n">career_summaries</span><span class="p">.</span><span class="n">ppg</span><span class="p">)</span><span class="w">
</span><span class="w">	</span><span class="k">FROM</span><span class="w"> </span><span class="n">teams</span><span class="w"> 
</span><span class="w">	</span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">players</span><span class="w">  
</span><span class="w">	  </span><span class="k">ON</span><span class="w"> </span><span class="n">teams</span><span class="w"> </span><span class="p">.</span><span class="n">teamId</span><span class="w"> </span><span class="o">=</span><span class="n">players</span><span class="w"> </span><span class="p">.</span><span class="n">teamId</span><span class="w">
</span><span class="w">	</span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">teams</span><span class="w"> </span><span class="c1">--加入 
</span><span class="c1"></span><span class="w">	  </span><span class="k">ON</span><span class="w"> </span><span class="n">players</span><span class="w"> </span><span class="p">.</span><span class="n">personId</span><span class="w"> </span><span class="o">=</span><span class="n">career_summaries</span><span class="w"> </span><span class="p">.</span><span class="n">personId</span><span class="w">
</span><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">teams</span><span class="p">.</span><span class="n">teamId</span><span class="w">
</span></code></pre></div><h2 id="union-垂直合併">UNION 垂直合併</h2>
<p>垂直合併簡單多了，他跟子查詢很像，就是位於資料表上方的SQL語句放UNION上面，要從下方合併的放UNION下面，</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="n">A</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">statement</span><span class="w">
</span><span class="w"></span><span class="k">UNION</span><span class="w">
</span><span class="w"></span><span class="n">Another</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">statement</span><span class="w">
</span></code></pre></div><h3 id="使用-union-的注意事項">使用 <code>UNION</code> 的注意事項</h3>
<ul>
<li>垂直合併的欄位數要相同。（如果沒有會產生error)</li>
<li>垂直合併的 SQL 若有使用到 <code>ORDER BY</code> 只能放在 <code>UNION</code> 之後。</li>
<li>垂直合併的重複觀測值會被省略。</li>
</ul>
<p>如果不要省略重複的觀測值，使用</p>
<h3 id="union-all">UNION ALL</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="n">A</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">statement</span><span class="w">
</span><span class="w"></span><span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span><span class="w">
</span><span class="w"></span><span class="n">Another</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">statement</span><span class="w">
</span></code></pre></div><p>就可以了</p>
<p><figure style="flex-grow: 125; flex-basis: 300px">
		<a href="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/union.jpg" data-size="722x576"><img src="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/union.jpg"
				srcset="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/union_hu982d2d84367483d65c6a1cc3f6a7218e_50465_480x0_resize_q75_box.jpg 480w, /p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/union_hu982d2d84367483d65c6a1cc3f6a7218e_50465_1024x0_resize_q75_box.jpg 1024w"
				width="722"
				height="576"
				loading="lazy"
				alt="垂直合併示意圖">
		</a>
		
		<figcaption>垂直合併示意圖</figcaption>
		
	</figure></p>
<h2 id="水平合併垂直合併的進階使用">水平合併＆垂直合併的進階使用</h2>
<p><em><strong>在50道連習題當中，有一題目如下：</strong></em></p>
<p><em><strong>從twElection2020 資料庫查詢中國國民黨、民主進步黨與親民黨在不分區立委與區域立委的得票率，參考下列的預期查詢結果。</strong></em></p>
<p><em><strong>PS 不分區立委的投票資料記錄於資料表 legislative_at_large</strong></em></p>
<p><em><strong>，區域立委的投票資料記錄於資料表 legislative_regional。</strong></em></p>
<p>預期輸出結果：</p>
<table>
<thead>
<tr>
<th>party</th>
<th>election</th>
<th>votes_percentage</th>
</tr>
</thead>
<tbody>
<tr>
<td>中國國民黨</td>
<td>不分區立委</td>
<td>0.3336</td>
</tr>
<tr>
<td>民主進步黨</td>
<td>不分區立委</td>
<td>0.3338</td>
</tr>
<tr>
<td>親民黨</td>
<td>不分區立委</td>
<td>0.0366</td>
</tr>
<tr>
<td>中國國民黨</td>
<td>區域立委</td>
<td>0.4071</td>
</tr>
<tr>
<td>民主進步黨</td>
<td>區域立委</td>
<td>0.4511</td>
</tr>
<tr>
<td>親民黨</td>
<td>區域立委</td>
<td>0.0043</td>
</tr>
</tbody>
</table>
<p>​</p>
<p>首先，先觀察個資料表</p>
<p>ER圖：</p>
<p><figure style="flex-grow: 101; flex-basis: 244px">
		<a href="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/twer.jpg" data-size="918x902"><img src="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/twer.jpg"
				srcset="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/twer_hub401fc515e342714dca8ad8bfe5b224d_330750_480x0_resize_q75_box.jpg 480w, /p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%983-%E6%B0%B4%E5%B9%B3%E5%90%88%E4%BD%B5join-on%E8%88%87%E5%9E%82%E7%9B%B4%E5%90%88%E4%BD%B5union/twer_hub401fc515e342714dca8ad8bfe5b224d_330750_1024x0_resize_q75_box.jpg 1024w"
				width="918"
				height="902"
				loading="lazy"
				alt="ER圖">
		</a>
		
		<figcaption>ER圖</figcaption>
		
	</figure></p>
<p>這題要先知道</p>
<p>不分區立委：簡單說就是政黨的得票，投黨不投人</p>
<p>所以不分區的比較簡單，連接兩種table就好，連結政黨parties資料表，再來這個資料表裡面存放黨派的id「id」，還有政黨名字「party」,透過存放政黨票的資料表 legislative_at_large，有得票數vote以及得票的政黨id「partyid」。</p>
<p>所以結合鍵就是政黨的id，</p>
<p>然後中間用UNION隔開，再來看區域立委：</p>
<p>再來是區域立委：投人的，</p>
<p>所以分區立委的投票率計算方法是：黨派裡面的所有所屬立委的得票數總和，要連接三張table，第一張是黨派的id名單，再來是立委所屬的黨派，再來是立委得票結果，</p>
<p>詳細解答：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span><span class="w"> </span><span class="n">parties</span><span class="p">.</span><span class="n">party</span><span class="w"> </span><span class="p">,</span><span class="w">
</span><span class="w">
</span><span class="w">		</span><span class="s1">&#39;不分區立委&#39;</span><span class="w"> </span><span class="n">election</span><span class="p">,</span><span class="w"> </span><span class="c1">--4.
</span><span class="c1"></span><span class="w">
</span><span class="w">		</span><span class="n">ROUNCAST</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">legislative_at_large</span><span class="p">.</span><span class="n">votes</span><span class="w"> </span><span class="p">)</span><span class="k">AS</span><span class="w"> </span><span class="nb">REAL</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">votes</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="c1">--5
</span><span class="c1"></span><span class="w">
</span><span class="w">									</span><span class="k">FROM</span><span class="w"> </span><span class="n">legislative_at_large</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">votes_percentage</span><span class="w">
</span><span class="w">
</span><span class="w">	</span><span class="k">FROM</span><span class="w"> </span><span class="n">parties</span><span class="w"> </span><span class="c1">--在最左邊的「黨派」
</span><span class="c1"></span><span class="w">
</span><span class="w">	</span><span class="k">JOIN</span><span class="w"> </span><span class="n">legislative_at_large</span><span class="w"> </span><span class="c1">--1.先設定好右側連結表
</span><span class="c1"></span><span class="w">
</span><span class="w">  </span><span class="k">ON</span><span class="w"> </span><span class="n">parties</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">legislative_at_large</span><span class="p">.</span><span class="n">party_id</span><span class="w"> </span><span class="c1">--2.連結條件
</span><span class="c1"></span><span class="w">
</span><span class="w">	</span><span class="k">WHERE</span><span class="w"> </span><span class="n">parties</span><span class="p">.</span><span class="n">party</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;中國國民黨&#39;</span><span class="p">,</span><span class="s1">&#39;民主進步黨&#39;</span><span class="p">,</span><span class="s1">&#39;親民黨&#39;</span><span class="p">)</span><span class="w"> </span><span class="c1">--3.直接篩選特定黨派
</span><span class="c1"></span><span class="w">
</span><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">parties</span><span class="p">.</span><span class="n">party</span><span class="w"> 
</span><span class="w">
</span><span class="w"></span><span class="k">UNION</span><span class="w"> </span><span class="c1">-------------------垂直相加第一步，複製上面跟下面，中間用UNION隔開
</span><span class="c1"></span><span class="w">
</span><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">parties</span><span class="p">.</span><span class="n">party</span><span class="w"> </span><span class="p">,</span><span class="w">
</span><span class="w">
</span><span class="w">	  </span><span class="s1">&#39;區域立委&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">election</span><span class="p">,</span><span class="w">
</span><span class="w">
</span><span class="w">		</span><span class="n">ROUND</span><span class="p">(</span><span class="k">CAST</span><span class="w"> </span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">legislative_regional</span><span class="p">.</span><span class="n">votes</span><span class="w"> </span><span class="p">)</span><span class="k">AS</span><span class="w"> </span><span class="nb">REAL</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">legislative_regional</span><span class="p">.</span><span class="n">votes</span><span class="w"> </span><span class="p">)</span><span class="c1">--6
</span><span class="c1"></span><span class="w">
</span><span class="w">																</span><span class="k">FROM</span><span class="w"> </span><span class="n">legislative_regional</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="k">AS</span><span class="w"> </span><span class="n">votes_percentage</span><span class="w"> </span><span class="c1">--6
</span><span class="c1"></span><span class="w">
</span><span class="w">	</span><span class="k">FROM</span><span class="w"> </span><span class="n">parties</span><span class="w"> </span><span class="c1">--1左邊的黨派
</span><span class="c1"></span><span class="w">
</span><span class="w">	</span><span class="k">JOIN</span><span class="w"> </span><span class="n">candidates</span><span class="w"> </span><span class="c1">--2.要先得知立委所屬黨派，目標是黨派LINK立委LINE立委編號
</span><span class="c1"></span><span class="w">
</span><span class="w">	 </span><span class="k">ON</span><span class="w"> </span><span class="n">parties</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">candidates</span><span class="p">.</span><span class="n">party_id</span><span class="w"> </span><span class="c1">--3.條件(得知立委所屬黨派，黨派表連結立委黨派表）
</span><span class="c1"></span><span class="w">
</span><span class="w">	</span><span class="k">JOIN</span><span class="w"> </span><span class="n">legislative_regional</span><span class="w"> </span><span class="c1">--4.加入立委得票數（立委黨派表連結立委得票數表）
</span><span class="c1"></span><span class="w">
</span><span class="w">	 </span><span class="k">ON</span><span class="w"> </span><span class="n">candidates</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">legislative_regional</span><span class="p">.</span><span class="n">candidate_id</span><span class="w"> </span><span class="c1">--5.立委個人id-立委得票id連結 
</span><span class="c1"></span><span class="w">
</span><span class="w">	</span><span class="k">WHERE</span><span class="w"> </span><span class="n">parties</span><span class="p">.</span><span class="n">party</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;中國國民黨&#39;</span><span class="p">,</span><span class="s1">&#39;民主進步黨&#39;</span><span class="p">,</span><span class="s1">&#39;親民黨&#39;</span><span class="p">)</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">parties</span><span class="p">.</span><span class="n">party</span><span class="w"> 
</span><span class="w">
</span><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">election</span><span class="w"> </span><span class="p">;</span><span class="c1">--垂直相加第二步，排版
</span></code></pre></div><p>差不多就是這樣！</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98/">SQL學習筆記</a>
        
            <a href="/tags/sql/">SQL</a>
        
            <a href="/tags/sqlite/">SQLite</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title"></h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%982-%E5%88%86%E7%B5%84group-by%E8%88%87%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B8%E7%B5%90%E6%9E%9C%E7%AF%A9%E9%81%B8%E5%AD%90%E6%9F%A5%E8%A9%A2/">
        
        
            <div class="article-image">
                <img src="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%982-%E5%88%86%E7%B5%84group-by%E8%88%87%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B8%E7%B5%90%E6%9E%9C%E7%AF%A9%E9%81%B8%E5%AD%90%E6%9F%A5%E8%A9%A2/logo.16b089f4da300c95ef33e058383663c8_hue91c0a6a1fc261792a7714a8d89d8466_163197_250x150_fill_q75_box_smart1.jpeg" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-FrCJ9NowDJXvM&#43;BYODZjyA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">SQL學習筆記(2)-分組(GROUP BY)與聚合函數結果篩選、子查詢</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%981-%E8%B3%87%E6%96%99%E6%9F%A5%E8%A9%A2%E7%8D%A8%E9%A1%AF%E4%B8%80%E5%80%BC%E9%81%8B%E7%AE%97%E7%AC%A6%E5%87%BD%E6%95%B8/">
        
        
            <div class="article-image">
                <img src="/p/sql%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%981-%E8%B3%87%E6%96%99%E6%9F%A5%E8%A9%A2%E7%8D%A8%E9%A1%AF%E4%B8%80%E5%80%BC%E9%81%8B%E7%AE%97%E7%AC%A6%E5%87%BD%E6%95%B8/logo.16b089f4da300c95ef33e058383663c8_hue91c0a6a1fc261792a7714a8d89d8466_163197_250x150_fill_q75_box_smart1.jpeg" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-FrCJ9NowDJXvM&#43;BYODZjyA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">SQL學習筆記(1)-資料查詢、獨顯一值、運算符、函數</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
     
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "yen0304" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (DISQUS) {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2022 Yen&#39;s部落格
    </section>
    
    <section class="powerby">
         <br />
        
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title"></h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ol>
    <li><a href="#前言">前言</a></li>
    <li><a href="#開發環境">開發環境</a></li>
    <li><a href="#join-on-水平合併">JOIN ON 水平合併</a>
      <ol>
        <li><a href="#格式">格式</a></li>
        <li><a href="#實際使用情境舉例">實際使用情境舉例</a></li>
        <li><a href="#撰寫流程">撰寫流程</a></li>
        <li><a href="#進階使用">進階使用</a>
          <ol>
            <li><a href="#分析">分析</a></li>
            <li><a href="#撰寫流程-1">撰寫流程</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#union-垂直合併">UNION 垂直合併</a>
      <ol>
        <li><a href="#使用-union-的注意事項">使用 <code>UNION</code> 的注意事項</a></li>
        <li><a href="#union-all">UNION ALL</a></li>
      </ol>
    </li>
    <li><a href="#水平合併垂直合併的進階使用">水平合併＆垂直合併的進階使用</a></li>
  </ol>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
