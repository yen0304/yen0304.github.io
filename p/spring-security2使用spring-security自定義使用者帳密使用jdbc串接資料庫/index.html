<!DOCTYPE html>
<html lang="zh-tw">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='使用Spring Security自定義使用者帳密，之後再使用JDBC串接資料庫，難度有點高花了點時間了解'><title>Spring Security(2)使用Spring Security自定義使用者帳密、使用JDBC串接資料庫</title>

<link rel='canonical' href='https://yen0304.github.io/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='Spring Security(2)使用Spring Security自定義使用者帳密、使用JDBC串接資料庫'>
<meta property='og:description' content='使用Spring Security自定義使用者帳密，之後再使用JDBC串接資料庫，難度有點高花了點時間了解'>
<meta property='og:url' content='https://yen0304.github.io/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/'>
<meta property='og:site_name' content='Yen&#39;s部落格'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Spring Security' /><meta property='article:tag' content='JDBC' /><meta property='article:tag' content='Springboot' /><meta property='article:tag' content='MYSQL' /><meta property='article:tag' content='JDBC Authentication' /><meta property='article:tag' content='WebSecurityConfigurerAdapter' /><meta property='article:tag' content='UserDetailsService' /><meta property='article:published_time' content='2021-09-04'/><meta property='article:modified_time' content='2021-09-04'/><meta property='og:image' content='https://yen0304.github.io/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/logo.jpeg' />
<meta name="twitter:title" content="Spring Security(2)使用Spring Security自定義使用者帳密、使用JDBC串接資料庫">
<meta name="twitter:description" content="使用Spring Security自定義使用者帳密，之後再使用JDBC串接資料庫，難度有點高花了點時間了解"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://yen0304.github.io/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/logo.jpeg' />
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-204387403-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="https://yen0304.github.io" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span></span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/">
                <img src="/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/logo_huf957eb7cc0803733802fcc4099cfd7cb_45239_800x0_resize_q75_box.jpeg"
                        srcset="/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/logo_huf957eb7cc0803733802fcc4099cfd7cb_45239_800x0_resize_q75_box.jpeg 800w, /p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/logo_huf957eb7cc0803733802fcc4099cfd7cb_45239_1600x0_resize_q75_box.jpeg 1600w"
                        width="800" 
                        height="450" 
                        loading="lazy"
                        alt="Featured image of post Spring Security(2)使用Spring Security自定義使用者帳密、使用JDBC串接資料庫" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/spring-security%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98/" >
                Spring Security學習筆記
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/">Spring Security(2)使用Spring Security自定義使用者帳密、使用JDBC串接資料庫</a>
    </h2>

    
    <h3 class="article-subtitle">
        使用Spring Security自定義使用者帳密，之後再使用JDBC串接資料庫，難度有點高花了點時間了解
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2021-09-04</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <p>繼上一章了解到了Spring Security基本的作用之後，本章節來繼續深入瞭解有關Spring Security中權限還有認證的相關設置，以及如何串接MySql資料庫數據來進行用戶認證
大概會用到的核心功能有JDBC Authentication、WebSecurityConfigurerAdapter、UserDetailsService</p>
<h2 id="自訂用戶查詢資料庫中帳號密碼">自訂用戶、查詢資料庫中帳號密碼</h2>
<p>在Spring Security中，自訂登入系統的帳號與密碼主要有二種方法兩種，第一種就是透過程式設定來在後臺上寫上固定的自定義帳號密碼，第二種則是</p>
<h4 id="添加依賴">添加依賴</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-security<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

</code></pre></div><h4 id="配置applicationproperties">配置application.properties</h4>
<p>語法如下，也是最簡單的方式，在resource下找到application.properties並輸入：</p>
<pre><code class="language-xml-dtd" data-lang="xml-dtd">spring.security.user.name=testad #自定義帳號
spring.security.user.password=abc123 #自定義密碼
</code></pre><h4 id="透過繼承類別websecurityconfigureradapter">透過繼承類別WebSecurityConfigurerAdapter</h4>
<p>先新增一個類別SecurityConfig來繼承WebSecurityConfigurerAdapter，WebSecurityConfigurerAdapter是專門用來配置Spring Security的一個類別：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Configuration</span>
<span class="c1">//小複習:當@Configuration加在class上，表示這是一個設定spring用的class（裡面寫的東西都是設定spring)
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfig</span> <span class="kd">extends</span> <span class="n">WebSecurityConfigurerAdapter</span> <span class="o">{</span>
  <span class="c1">//...
</span><span class="c1"></span><span class="o">}</span>
</code></pre></div><p>再來使用configure方法來設置我們的用戶設定，在IDEA中點擊右鍵-&gt;Generate-&gt;Override Methods選擇我們要覆寫的方法configure(AuthenticationManagerBuilder auth)（真是方便）</p>
<p>會出現：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="n">AuthenticationManagerBuilder</span> <span class="n">auth</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">.</span><span class="na">configure</span><span class="o">(</span><span class="n">auth</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div><p>在這個方法中，主要透過auth來設置我們的用戶名以及密碼，但在下面得例子中，也使用了Spring Security提供了類別的BCryptPasswordEncoder來加密我們的密碼，在使用BCryptPasswordEncoder時，因為我們改變了password()的接受參數類型，所以也要記得使用@Bean來實作一個password類型</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Bean</span>
<span class="n">PasswordEncoder</span> <span class="nf">password</span><span class="o">(){</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">BCryptPasswordEncoder</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div><p>再來就是Spring Security在進行安全驗證時，會收到輸入請求中的使用者名稱(username)，然後呼叫UserDetailsService，UserDetailsService是Spring Security用來載入使用者資訊的一個組件，他的功能就是可以提供UserDetailsService中的一個方法loadUserByUsername(String username)，來依據username回傳資料型別UserDetails的使用者資訊（參考文章：<a class="link" href="https://matthung0807.blogspot.com/2019/09/spring-security-userdetailsservice.html"  target="_blank" rel="noopener"
    >Spring Security UserDetailsService 用途</a>)</p>
<p>所以我們先</p>
<h4 id="實作userdetailsservice">實作UserDetailsService</h4>
<p>在implements UserDetailsService的時候，只需要實作一個方法就好，那就是loadUserByUsername，在學習這裡時，稍微了解到了@Service以及＠Component的差別，就是除了閱讀讓人知道Service是處理業務邏輯之外，實際上功能其實都是一樣讓class變成Bean。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="c1">//MyUsersDetailService完整程式碼：
</span><span class="c1"></span>
<span class="nd">@Service</span> 
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyUsersDetailService</span> <span class="kd">implements</span> <span class="n">UserDetailsService</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">UserDetails</span> <span class="nf">loadUserByUsername</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">UsernameNotFoundException</span> <span class="o">{</span>
        <span class="c1">//權限(固定用法,role是還沒用到所以拿來暫時先隨便亂取）
</span><span class="c1"></span>        <span class="n">List</span><span class="o">&lt;</span><span class="n">GrantedAuthority</span><span class="o">&gt;</span> <span class="n">auths</span> <span class="o">=</span> <span class="n">AuthorityUtils</span><span class="o">.</span><span class="na">commaSeparatedStringToAuthorityList</span><span class="o">(</span><span class="s">&#34;role&#34;</span><span class="o">);</span>
        <span class="c1">//return 用戶名稱,密碼,用戶角色（權限），用戶角色不可以為Null!
</span><span class="c1"></span>        <span class="k">return</span> <span class="k">new</span> <span class="n">User</span><span class="o">(</span><span class="s">&#34;testusername&#34;</span><span class="o">,</span><span class="k">new</span> <span class="n">BCryptPasswordEncoder</span><span class="o">().</span><span class="na">encode</span><span class="o">(</span><span class="s">&#34;abc123&#34;</span><span class="o">),</span><span class="n">auths</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div><p>再來就是在SecurityConfig使用@Autowird,但會發現：</p>
<p><figure style="flex-grow: 160; flex-basis: 384px">
		<a href="/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/autowird%E9%8C%AF%E8%AA%A4.png" data-size="2880x1800"><img src="/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/autowird%E9%8C%AF%E8%AA%A4.png"
				srcset="/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/autowird%E9%8C%AF%E8%AA%A4_huab69f6cbb7f2ce5d8ebcd3f85231cf7a_667945_480x0_resize_box_3.png 480w, /p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/autowird%E9%8C%AF%E8%AA%A4_huab69f6cbb7f2ce5d8ebcd3f85231cf7a_667945_1024x0_resize_box_3.png 1024w"
				width="2880"
				height="1800"
				loading="lazy"
				alt="autowird錯誤">
		</a>
		
		<figcaption>autowird錯誤</figcaption>
		
	</figure></p>
<p>這是因為springboot找到兩個相同類型的Bean，但只要加上@Qualifier就可以解決了（複習：bean名字是class名稱第一個字轉成小寫）</p>
<p>所以變成這樣：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Autowired</span>
<span class="nd">@Qualifier</span><span class="o">(</span><span class="s">&#34;myUsersDetailService&#34;</span><span class="o">)</span>
<span class="kd">private</span> <span class="n">UserDetailsService</span> <span class="n">userDetailsService</span><span class="o">;</span>
</code></pre></div><p>到這裡，就可以嘗試使用帳號testusername，密碼abc123登入頁面了，完整的SecurityConfig程式碼如下：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Configuration</span>
<span class="c1">//小複習:當@Configuration加在class上，表示這是一個設定spring用的class（裡面寫的東西都是設定spring)
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfig</span> <span class="kd">extends</span> <span class="n">WebSecurityConfigurerAdapter</span> <span class="o">{</span>


    <span class="nd">@Autowired</span>
    <span class="nd">@Qualifier</span><span class="o">(</span><span class="s">&#34;myUsersDetailService&#34;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">UserDetailsService</span> <span class="n">userDetailsService</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="n">AuthenticationManagerBuilder</span> <span class="n">auth</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">auth</span><span class="o">.</span><span class="na">userDetailsService</span><span class="o">(</span><span class="n">userDetailsService</span><span class="o">).</span><span class="na">passwordEncoder</span><span class="o">(</span><span class="n">password</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="n">PasswordEncoder</span> <span class="nf">password</span><span class="o">(){</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">BCryptPasswordEncoder</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><p>透過以上步驟就算是可以在程式裡面新增自定義的用戶帳號密碼了，接下來就是要嘗試連接MySql資料庫來透過Spring Security做登入，在這之前其實有稍微了解了一下大致上有兩種方法，第一種方法是由上面的程式繼續使用Spring Security結合MyBatis，主要就是在另外在 MyUsersDetailService中利用MyBatis＋Mapper的方式對資料庫做操作把return值稍微更改成資料庫查詢出來的數據並在驗證，詳細介紹影片：<a class="link" href="https://www.youtube.com/watch?v=HCJH6I5egJk&amp;list=PLmOn9nNkQxJEnBjOMEXPLRjoTRNvhHIl2&amp;index=11"  target="_blank" rel="noopener"
    >youtube</a></p>
<h2 id="透過mysql以及jdbc來做登入-jdbcauthentication">透過MySql以及JDBC來做登入-jdbcAuthentication</h2>
<p>第二種方法其實Spring Security 提供了 JDBC User Service，比起在前面實作UserDetailsService的時，會少了很多步驟，Spring Security提供的JDBC User Service設定也比較簡單，首先需要加入相關的依賴：</p>
<h4 id="添加maven配置">添加Maven配置</h4>
<p>添加了JDBC、ＭySql</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-jdbc<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="c">&lt;!-- https://mvnrepository.com/artifact/mysql/mysql-connector-java --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>mysql<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>mysql-connector-java<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>8.0.22<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div><h4 id="資料庫設定">資料庫設定</h4>
<p>簡單的設定一下資料庫</p>
<p><figure style="flex-grow: 116; flex-basis: 280px">
		<a href="/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/mysql%E8%A8%AD%E7%BD%AE.png" data-size="1598x1368"><img src="/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/mysql%E8%A8%AD%E7%BD%AE.png"
				srcset="/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/mysql%E8%A8%AD%E7%BD%AE_hufa21137434d48e09642a8dde6159b6dc_273116_480x0_resize_box_3.png 480w, /p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/mysql%E8%A8%AD%E7%BD%AE_hufa21137434d48e09642a8dde6159b6dc_273116_1024x0_resize_box_3.png 1024w"
				width="1598"
				height="1368"
				loading="lazy"
				>
		</a>
		
	</figure></p>
<p>在使用jdbcAuthentication時，可以先稍微了解下面函式：</p>
<table>
<thead>
<tr>
<th style="text-align:center">函式</th>
<th style="text-align:center">功能</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">jdbcAuthentication()</td>
<td style="text-align:center">表示我們正在使用 JDBC 身份驗證，固定寫法</td>
</tr>
<tr>
<td style="text-align:center">dataSource(Datasource dataSource)</td>
<td style="text-align:center">表示我們正在使用 JDBC 身份驗證，固定寫法</td>
</tr>
<tr>
<td style="text-align:center">usersByUsernameQuery(String query)</td>
<td style="text-align:center">設定查找用戶資料的sql語句</td>
</tr>
<tr>
<td style="text-align:center">authoritiesByUsernameQuery(String query)</td>
<td style="text-align:center">設定查找用戶權限的sql語句</td>
</tr>
</tbody>
</table>
<p>知道了這些之後，在Spring Security使用 JDBC時，寫法跟格式是相對固定的，但也是官方建議的寫法，有要求在執行sql的語句usersByUsernameQuery有三樣東西不能少回傳，也就是説在Table裡面一定要有這些數據，就是帳號（username)、密碼(password)、以及是否啟用(Enabled)，authoritiesByUsernameQuery則是要求帳號（username)、以及角色(role)，且一定要使用到上面那些函式，如果我們沒有回傳權限的話，錯誤訊息大致上會長這樣：</p>
<p><figure style="flex-grow: 71; flex-basis: 171px">
		<a href="/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/error.png" data-size="341x478"><img src="/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/error.png"
				srcset="/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/error_hufe2add793b1b2fe675ca0fc9e08cbaec_42985_480x0_resize_box_3.png 480w, /p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/error_hufe2add793b1b2fe675ca0fc9e08cbaec_42985_1024x0_resize_box_3.png 1024w"
				width="341"
				height="478"
				loading="lazy"
				>
		</a>
		
	</figure></p>
<p>所以我們就開始設定的Database，以及先創造使用者資料如下：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">securitydata</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="n">username</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span><span class="w">
</span><span class="w">    </span><span class="n">password</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">60</span><span class="p">),</span><span class="w">
</span><span class="w">    </span><span class="k">role</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="n">enabled</span><span class="w"> </span><span class="n">TINYINT</span><span class="w">
</span><span class="w"></span><span class="p">)</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">,</span><span class="k">role</span><span class="p">,</span><span class="n">enabled</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;abc123&#39;</span><span class="p">,</span><span class="s1">&#39;ROLE_ADMIN&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">,</span><span class="k">role</span><span class="p">,</span><span class="n">enabled</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;uuu123&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ccc123&#39;</span><span class="p">,</span><span class="s1">&#39;ROLE_USER&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">,</span><span class="k">role</span><span class="p">,</span><span class="n">enabled</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dog555&#39;</span><span class="p">,</span><span class="s1">&#39;ROLE_USER&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">,</span><span class="k">role</span><span class="p">,</span><span class="n">enabled</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;888&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;yuyu&#39;</span><span class="p">,</span><span class="s1">&#39;ROLE_USER&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w">
</span></code></pre></div><p>接著就在SecurityConfig裡面完成我們的設定，</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Configuration</span>
<span class="c1">//小複習:當@Configuration加在class上，表示這是一個設定spring用的class（裡面寫的東西都是設定spring)
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfig</span> <span class="kd">extends</span> <span class="n">WebSecurityConfigurerAdapter</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">DataSource</span> <span class="n">dataSource</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="n">AuthenticationManagerBuilder</span> <span class="n">auth</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">sql</span><span class="o">=</span><span class="s">&#34;SELECT username,password,enabled FROM users WHERE username=?&#34;</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">authorsql</span><span class="o">=</span><span class="s">&#34;SELECT username,role FROM users WHERE username=?&#34;</span><span class="o">;</span>
        <span class="n">auth</span><span class="o">.</span><span class="na">jdbcAuthentication</span><span class="o">()</span>
                <span class="o">.</span><span class="na">dataSource</span><span class="o">(</span><span class="n">dataSource</span><span class="o">)</span>
                <span class="o">.</span><span class="na">usersByUsernameQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">)</span>
                <span class="o">.</span><span class="na">authoritiesByUsernameQuery</span><span class="o">(</span><span class="n">authorsql</span><span class="o">)</span>
                <span class="o">.</span><span class="na">passwordEncoder</span><span class="o">(</span><span class="k">new</span> <span class="n">BCryptPasswordEncoder</span><span class="o">());</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div><p>完成了之後，我們嘗試運行程式並且登入會出現下面的畫面：</p>
<p><figure style="flex-grow: 114; flex-basis: 275px">
		<a href="/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/bad_credentials.png" data-size="375x327"><img src="/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/bad_credentials.png"
				srcset="/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/bad_credentials_hue0db3ff263123ca931bf0d27d288e36d_17044_480x0_resize_box_3.png 480w, /p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/bad_credentials_hue0db3ff263123ca931bf0d27d288e36d_17044_1024x0_resize_box_3.png 1024w"
				width="375"
				height="327"
				loading="lazy"
				>
		</a>
		
	</figure></p>
<p>原因是因為，我們在configure裡面使用了passwordEncoder做加密，但是對於sql資料庫來說，密碼卻沒有加密，所以我們就直接使用update寫法，幫我們先產生出加密完的密碼並存放到資料庫，這邊要記得在資料庫中<code>password VARCHAR(60)</code>是因為加密後的長度會超過本來設定的(30)所以我參考了網路上給的長度(60)</p>
<p>完整程式碼長這樣：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Configuration</span>
<span class="c1">//小複習:當@Configuration加在class上，表示這是一個設定spring用的class（裡面寫的東西都是設定spring)
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfig</span> <span class="kd">extends</span> <span class="n">WebSecurityConfigurerAdapter</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">DataSource</span> <span class="n">dataSource</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">NamedParameterJdbcTemplate</span> <span class="n">namedParameterJdbcTemplate</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="n">AuthenticationManagerBuilder</span> <span class="n">auth</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">BCryptPasswordEncoder</span> <span class="n">encoder</span><span class="o">=</span><span class="k">new</span> <span class="n">BCryptPasswordEncoder</span><span class="o">();</span>
        <span class="c1">//設定自定義密碼
</span><span class="c1"></span>        <span class="n">String</span> <span class="n">rawpassword</span> <span class="o">=</span> <span class="s">&#34;ccc123&#34;</span><span class="o">;</span>
        <span class="c1">//設定變數，這個變數存放加密完成後的密碼
</span><span class="c1"></span>        <span class="n">String</span> <span class="n">encodepassword</span> <span class="o">=</span><span class="n">encoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="n">rawpassword</span><span class="o">);</span>
        <span class="n">String</span> <span class="n">encodesql</span><span class="o">=</span><span class="s">&#34;UPDATE users SET password=:userpassword WHERE username=&#39;uuu123&#39;&#34;</span><span class="o">;</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span><span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;userpassword&#34;</span><span class="o">,</span><span class="n">encodepassword</span><span class="o">);</span>
        <span class="n">namedParameterJdbcTemplate</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">encodesql</span><span class="o">,</span><span class="n">map</span><span class="o">);</span>
				<span class="c1">//要記得上面會一直重複，算是臨時性測試用的
</span><span class="c1"></span>      
        <span class="n">String</span> <span class="n">sql</span><span class="o">=</span><span class="s">&#34;SELECT username,password,enabled FROM users WHERE username=?&#34;</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">authorsql</span><span class="o">=</span><span class="s">&#34;SELECT username,role FROM users WHERE username=?&#34;</span><span class="o">;</span>
       <span class="c1">// auth.userDetailsService(userDetailsService).passwordEncoder(password());
</span><span class="c1"></span>        <span class="n">auth</span><span class="o">.</span><span class="na">jdbcAuthentication</span><span class="o">()</span>
                <span class="o">.</span><span class="na">dataSource</span><span class="o">(</span><span class="n">dataSource</span><span class="o">)</span>
                <span class="o">.</span><span class="na">usersByUsernameQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">)</span>
                <span class="o">.</span><span class="na">authoritiesByUsernameQuery</span><span class="o">(</span><span class="n">authorsql</span><span class="o">)</span>
                <span class="o">.</span><span class="na">passwordEncoder</span><span class="o">(</span><span class="k">new</span> <span class="n">BCryptPasswordEncoder</span><span class="o">());</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div><p>運行程式看到Started DemoApplication後，可以直接看到Table資料已經改變：</p>
<p><figure style="flex-grow: 731; flex-basis: 1755px">
		<a href="/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/encodesucess.png" data-size="2004x274"><img src="/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/encodesucess.png"
				srcset="/p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/encodesucess_hud535edd8db55079fdc758854b4b31172_75008_480x0_resize_box_3.png 480w, /p/spring-security2%E4%BD%BF%E7%94%A8spring-security%E8%87%AA%E5%AE%9A%E7%BE%A9%E4%BD%BF%E7%94%A8%E8%80%85%E5%B8%B3%E5%AF%86%E4%BD%BF%E7%94%A8jdbc%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99%E5%BA%AB/encodesucess_hud535edd8db55079fdc758854b4b31172_75008_1024x0_resize_box_3.png 1024w"
				width="2004"
				height="274"
				loading="lazy"
				>
		</a>
		
	</figure></p>
<p>之後就可以登入成功並且看到畫面了！（淚）</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/spring-security/">Spring Security</a>
        
            <a href="/tags/jdbc/">JDBC</a>
        
            <a href="/tags/springboot/">Springboot</a>
        
            <a href="/tags/mysql/">MYSQL</a>
        
            <a href="/tags/jdbc-authentication/">JDBC Authentication</a>
        
            <a href="/tags/websecurityconfigureradapter/">WebSecurityConfigurerAdapter</a>
        
            <a href="/tags/userdetailsservice/">UserDetailsService</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title"></h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/p/spring-security4%E8%A8%AA%E5%95%8F%E6%AC%8A%E9%99%90%E8%A8%BB%E8%A7%A3securitdpreauthorize/">
        
        
            <div class="article-image">
                <img src="/p/spring-security4%E8%A8%AA%E5%95%8F%E6%AC%8A%E9%99%90%E8%A8%BB%E8%A7%A3securitdpreauthorize/logo.1822297e872c493d64bb61209de7e462_huf957eb7cc0803733802fcc4099cfd7cb_45239_250x150_fill_q75_box_smart1.jpeg" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-GCIpfocsST1ku2EgnefkYg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Spring Security(4)訪問權限註解@Securitd、@PreAuthorize</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/spring-security3%E8%87%AA%E5%AE%9A%E7%BE%A9%E7%99%BB%E5%85%A5%E9%A0%81%E9%9D%A2%E6%8E%A7%E5%88%B6%E8%A7%92%E8%89%B2%E6%AC%8A%E9%99%90%E7%99%BB%E5%85%A5/">
        
        
            <div class="article-image">
                <img src="/p/spring-security3%E8%87%AA%E5%AE%9A%E7%BE%A9%E7%99%BB%E5%85%A5%E9%A0%81%E9%9D%A2%E6%8E%A7%E5%88%B6%E8%A7%92%E8%89%B2%E6%AC%8A%E9%99%90%E7%99%BB%E5%85%A5/logo.1822297e872c493d64bb61209de7e462_huf957eb7cc0803733802fcc4099cfd7cb_45239_250x150_fill_q75_box_smart1.jpeg" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-GCIpfocsST1ku2EgnefkYg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Spring Security(3)自定義登入頁面、控制角色權限登入</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/spring-security1%E8%AA%8D%E8%AD%98spring-security%E5%BE%AE%E6%BC%94%E7%B7%B4/">
        
        
            <div class="article-image">
                <img src="/p/spring-security1%E8%AA%8D%E8%AD%98spring-security%E5%BE%AE%E6%BC%94%E7%B7%B4/logo.1822297e872c493d64bb61209de7e462_huf957eb7cc0803733802fcc4099cfd7cb_45239_250x150_fill_q75_box_smart1.jpeg" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-GCIpfocsST1ku2EgnefkYg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Spring Security(1)認識Spring Security＆微演練</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/spring-boot-%E7%AE%A1%E7%90%86%E6%9C%83%E5%93%A1%E8%B3%87%E6%96%99%E4%BA%8C-crud%E4%B9%8Brud%E6%93%8D%E4%BD%9C/">
        
        
            <div class="article-image">
                <img src="/p/spring-boot-%E7%AE%A1%E7%90%86%E6%9C%83%E5%93%A1%E8%B3%87%E6%96%99%E4%BA%8C-crud%E4%B9%8Brud%E6%93%8D%E4%BD%9C/cover.515ea5998aae5c8c8061fb33c57b92e0_hu3d03a01dcc18bc5be0e67db3d8d209a6_702789_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-UV6lmYquXIyAYfszxXuS4A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Spring Boot 管理會員資料（二）-CRUD之RUD操作</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/spring-boot-%E7%AE%A1%E7%90%86%E6%9C%83%E5%93%A1%E8%B3%87%E6%96%99%E4%B8%80-%E6%9C%83%E5%93%A1%E5%89%B5%E5%BB%BA-crud-create/">
        
        
            <div class="article-image">
                <img src="/p/spring-boot-%E7%AE%A1%E7%90%86%E6%9C%83%E5%93%A1%E8%B3%87%E6%96%99%E4%B8%80-%E6%9C%83%E5%93%A1%E5%89%B5%E5%BB%BA-crud-create/cover.515ea5998aae5c8c8061fb33c57b92e0_hu3d03a01dcc18bc5be0e67db3d8d209a6_702789_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-UV6lmYquXIyAYfszxXuS4A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Spring Boot 管理會員資料（一）-會員創建 CRUD-Create</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
     
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "yen0304" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (DISQUS) {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2022 Yen&#39;s部落格
    </section>
    
    <section class="powerby">
         <br />
        
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title"></h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ol>
    <li><a href="#自訂用戶查詢資料庫中帳號密碼">自訂用戶、查詢資料庫中帳號密碼</a>
      <ol>
        <li>
          <ol>
            <li><a href="#添加依賴">添加依賴</a></li>
            <li><a href="#配置applicationproperties">配置application.properties</a></li>
            <li><a href="#透過繼承類別websecurityconfigureradapter">透過繼承類別WebSecurityConfigurerAdapter</a></li>
            <li><a href="#實作userdetailsservice">實作UserDetailsService</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#透過mysql以及jdbc來做登入-jdbcauthentication">透過MySql以及JDBC來做登入-jdbcAuthentication</a>
      <ol>
        <li>
          <ol>
            <li><a href="#添加maven配置">添加Maven配置</a></li>
            <li><a href="#資料庫設定">資料庫設定</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
